---
# OpenSpace Platform Configuration
# This file contains all deployment variables
# Run 'task prep' to generate Ansible inventory from this config

# ==============================================================================
# DEPLOYMENT METADATA
# ==============================================================================
deployment:
  name: "test-onboarder-server"
  type: "basekit"
  onboarder_version: "3.5.0-rc7"
  osms_tooling_version: "1.8.x"

# ==============================================================================
# SSH CONFIGURATION
# ==============================================================================
ssh:
  user: "kratos"
  pass: "kratos"
  become: "kratos"

# ==============================================================================
# NETWORK CONFIGURATION
# ==============================================================================
networks:
  # Customer/WAN Network (External)
  customer:
    gateway: "10.243.76.1"
    cidr: "/23"
    dns_servers:
      - "10.243.25.50"
      - "10.243.25.53"
  
  # Management Network (Internal Cluster)
  management:
    network: "10.243.77"
    cidr: "/23"
    gateway: "10.243.76.1"
    dns_servers:
      - "10.243.25.50"
      - "10.243.25.53"
  
  # IDRAC Network
  idrac:
    network: "192.168.0"
    cidr: "/24"
    gateway: "192.168.0.1"

# ==============================================================================
# DOMAIN CONFIGURATION
# ==============================================================================
domain:
  base: "test.integration.kratos"

# ==============================================================================
# NTP CONFIGURATION
# ==============================================================================
ntp:
  server: "192.168.2.100"
  timezone: "Etc/UTC"

# ==============================================================================
# INFRASTRUCTURE HOSTS
# ==============================================================================
infrastructure:
  # Management Hypervisor
  mgmt_kvm:
    wan_ip: "10.243.76.35"
    wan_interface: "eno1"
    mgmt_ip: "10.243.76.11"
    mgmt_interface: "eno2"
    idrac_ip: "192.168.0.4"
    idrac_interface: "ens3f0"
    prov_interface: "eno8303"
  
  # OPNsense Firewall
  opnsense:
    wan_ip: "10.243.77.227"
    mgmt_ip: "10.243.77.228"

# ==============================================================================
# CLUSTER NODES
# ==============================================================================
# MCM - Infrastructure/Management Cluster
management_cluster:
  clusters:
    - cluster_name: "local"
      ssh_key: "mcm_ssh_key"
      nodes:
        - name: "mcm1"
          mgmt_ip: "10.243.77.229"
          mgmt_interface: "enp1s0"
          idrac_ip: "192.168.0.8"
          roles: ["controlplane", "etcd", "worker"]
  
# OSMS - OpenSpace Management System
openspace_management_system:
  clusters:
    - cluster_name: "openspace-osms"
      ssh_key: "osms_ssh_key"
      nodes:
        - name: "osms1"
          mgmt_ip: "10.243.77.231"
          mgmt_interface: "enp1s0"
          idrac_ip: "192.168.0.9"
          roles: ["controlplane", "etcd", "worker"]
  
# ==============================================================================
# STORAGE CONFIGURATION
# ==============================================================================
storage:
  # NFS storage (if applicable)
  nfs:
    enabled: false
    server: "192.168.2.100"
    path: "/exports/openspace"

# ==============================================================================
# VIRTUAL MACHINE CONFIGURATION (for basekit deployments)
# ==============================================================================
virtual_machines:
  mcm:
    name: "mcm"
    memory: 16384  # MB
    vcpus: 8
    disk_size: 100  # GB
    # Network config pulled from management_cluster.clusters[0].nodes[0]
  
  osms:
    name: "osms"
    memory: 32768  # MB
    vcpus: 16
    disk_size: 100  # GB
    # Network config pulled from openspace_management_system.clusters[0].nodes[0]
