# ==============================================================================
# Ansible Inventory - GENERATED FILE
# ==============================================================================
# ⚠️  DO NOT EDIT THIS FILE MANUALLY
# 
# This file is GENERATED from: deployment.yml
# To make changes:
#   1. Edit deployment.yml
#   2. Run: task prep-config
#   3. This file will be regenerated
# 
# Generated: {{ ansible_date_time.iso8601 }}
# Source: {{ deployment.name }}
# ==============================================================================

all:
  children:
    deployment:
      vars:
        # ======================================================================
        # SSH Configuration
        # ======================================================================
        ansible_user: "{{ ssh.user }}"
        ansible_ssh_pass: "{{ ssh.pass }}"
        ansible_become_pass: "{{ ssh.become }}"
      hosts:
        # ======================================================================
        # Localhost
        # ======================================================================
        localhost:
          ansible_connection: local
        
        # ======================================================================
        # Infrastructure Hosts
        # ======================================================================
        opnsense:
          ansible_host: {{ infrastructure.opnsense.wan_ip }}
        
        mgmt_kvm:
          ansible_host: {{ infrastructure.mgmt_kvm.wan_ip }}
      
      children:
        # ======================================================================
        # Cluster Definitions
        # ======================================================================
        clusters:
          children:
            # ==================================================================
            # Infrastructure/Management Cluster (MCM)
            # ==================================================================
            management_cluster:
              children:
{% for cluster in management_cluster.clusters %}
                {{ cluster.cluster_name | replace('-', '_') }}:
                  hosts:
{% for node in cluster.nodes %}
                    {{ node.name }}:
                      ansible_host: {{ node.mgmt_ip }}
{% endfor %}
{% endfor %}
            
            # ==================================================================
            # Downstream Clusters
            # ==================================================================
            downstream_clusters:
              children:
                # ==============================================================
                # OpenSpace Management Cluster (OSMS)
                # ==============================================================
                openspace_management_system:
                  children:
{% if openspace_management_system is defined %}
{% for cluster in openspace_management_system.clusters %}
                    {{ cluster.cluster_name | replace('-', '_') }}:
                      hosts:
{% for node in cluster.nodes %}
                        {{ node.name }}:
                          ansible_host: {{ node.mgmt_ip }}
{% endfor %}
{% endfor %}
{% endif %}
                
                # ==============================================================
                # OpenSpace Data Cluster (OSDC)
                # ==============================================================
                openspace_datapath_cluster:
                  children:
{% if openspace_datapath_cluster is defined %}
{% for cluster in openspace_datapath_cluster.clusters %}
                    {{ cluster.cluster_name | replace('-', '_') }}:
                      hosts:
{% for node in cluster.nodes %}
                        {{ node.name }}:
                          ansible_host: {{ node.mgmt_ip }}
{% endfor %}
{% endfor %}
{% endif %}
