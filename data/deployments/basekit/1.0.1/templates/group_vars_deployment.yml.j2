# ==============================================================================
# Deployment Variables - GENERATED FILE
# ==============================================================================
# ⚠️  DO NOT EDIT THIS FILE MANUALLY
# 
# This file is GENERATED from: deployment.yml
# To make changes:
#   1. Edit deployment.yml
#   2. Run: task prep-config
#   3. This file will be regenerated
# 
# Generated: {{ ansible_date_time.iso8601 }}
# ==============================================================================

# ==============================================================================
# Deployment Metadata
# ==============================================================================
deployment_name: "{{ deployment.name }}"
deployment_type: "{{ deployment.type }}"
deployment_version: "{{ deployment.version }}"

# ==============================================================================
# Cluster Configuration
# ==============================================================================

# Management Cluster (MCM)
{% if clusters.management_cluster is defined %}
{% for cluster in clusters.management_cluster.clusters %}
mcm_cluster_name: "{{ cluster.cluster_name }}"
mcm_nodes:
{% for node in cluster.nodes %}
  - name: "{{ node.name }}"
    mgmt_ip: "{{ node.mgmt_ip }}"
    roles: {{ node.roles | to_json }}
{% endfor %}
{% endfor %}
{% endif %}

# OpenSpace Management System (OSMS)
{% if clusters.openspace_management_system is defined %}
{% for cluster in clusters.openspace_management_system.clusters %}
osms_cluster_name: "{{ cluster.cluster_name }}"
{% if cluster.deployment_yaml is defined %}
osms_deployment_yaml: "{{ cluster.deployment_yaml }}"
{% endif %}
osms_nodes:
{% for node in cluster.nodes %}
  - name: "{{ node.name }}"
    mgmt_ip: "{{ node.mgmt_ip }}"
    roles: {{ node.roles | to_json }}
{% endfor %}
{% endfor %}
{% endif %}

# OpenSpace Data Cluster (OSDC)
{% if clusters.openspace_datapath_cluster is defined %}
{% for cluster in clusters.openspace_datapath_cluster.clusters %}
osdc_cluster_name: "{{ cluster.cluster_name }}"
{% if cluster.deployment_yaml is defined %}
osdc_deployment_yaml: "{{ cluster.deployment_yaml }}"
{% endif %}
osdc_nodes:
{% for node in cluster.nodes %}
  - name: "{{ node.name }}"
    mgmt_ip: "{{ node.mgmt_ip }}"
    roles: {{ node.roles | to_json }}
{% if node.mac_address is defined %}
    mac_address: "{{ node.mac_address }}"
{% endif %}
{% endfor %}
{% endfor %}
{% endif %}

# ==============================================================================
# Virtual IPs
# ==============================================================================
{% if vips is defined %}
virtual_ips:
  osdc: "{{ vips.osdc | default('') }}"
  osms: "{{ vips.osms | default('') }}"
  api_osdc: "{{ vips.api_osdc | default('') }}"
  api_osms: "{{ vips.api_osms | default('') }}"
  api_mcm: "{{ vips.api_mcm | default('') }}"
  mcm_wildcard: "{{ vips.mcm_wildcard | default('') }}"
{% endif %}
