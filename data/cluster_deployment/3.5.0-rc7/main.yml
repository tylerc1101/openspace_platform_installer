version: '3'

tasks:
  prep-cluster-nodes:
    desc: Prepare Cluster Nodes for Deployment
    cmds:
      - python3 {{.DATA_DIR}}/run_task.py 
          --task-id=prep-cluster-nodes 
          --hosts={{.HOSTS}} 
          --file={{.DATA_DIR}}/cluster_deployment/{{.ONBOARDER_VERSION}}/tasks/prep_cluster_nodes.yml 
          --kind=ansible

  deploy-clusters:
    desc: Deploy OpenSpace Clusters
    cmds:
      - python3 {{.DATA_DIR}}/run_task.py 
          --task-id=deploy-clusters 
          --hosts={{.HOSTS}} 
          --file={{.DATA_DIR}}/cluster_deployment/{{.ONBOARDER_VERSION}}/tasks/deploy_clusters.yml 
          --kind=ansible

  deploy-all:
    desc: Run All Cluster Deployment Tasks
    cmds:
      - task: prep-cluster-nodes
      - task: deploy-clusters