---
- name: Deploy Downstream Clusters
  hosts: "{{ target_hosts }}"
  vars:
    env_dir: "/docker-workspace/config/{{ env_name }}"
  
  tasks:
    - name: Display clusters to deploy
      ansible.builtin.debug:
        msg: "Clusters to deploy: {{ clusters_to_deploy }}"

    - name: Process each downstream cluster
      include_tasks: deploy_single_cluster.yml
      loop: "{{ clusters_to_deploy }}"
      loop_control:
        loop_var: cluster_group_name